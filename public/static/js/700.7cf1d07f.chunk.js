"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[700],{5619:function(e,t,n){var r=n(7182),a=n(6491),o=n(8079),i=n(5208),s=n(8060),l=n(3239),c=n(2053),d=n(4857),u=n(3564),f=n(4414);const x=e=>{let{icon:t,onClick:n,isDark:r}=e;const s=(0,d.A)();return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(a.A,{sx:{ml:2,mr:3,[s.breakpoints.down("md")]:{mr:2}},children:(0,f.jsx)(o.A,{children:(0,f.jsx)(i.A,{sx:{...s.typography.commonAvatar,...s.typography.mediumAvatar,transition:"all .2s ease-in-out",background:r?s.palette.secondary.main:s.palette.background.default,color:r?s.palette.background.default:s.palette.secondary.main},onClick:n,color:"inherit",children:t})})})})};t.A=e=>{let{avatarImage:t=null,title:n=null,isDark:o=!0}=e;const h=(0,d.A)(),p=(0,u.Zp)();return(0,f.jsx)(s.A,{enableColorOnDark:!0,color:"inherit",position:"relative",elevation:0,sx:{bgcolor:o?h.palette.secondary.main:h.palette.background.default},children:(0,f.jsxs)(l.A,{children:[(0,f.jsx)(x,{icon:(0,f.jsx)(r.A,{stroke:1.5,size:"1.3rem"}),onClick:()=>{p(-1)},isDark:o}),t&&(0,f.jsx)(i.A,{alt:"",src:t}),n&&(0,f.jsx)(c.A,{variant:"h4",sx:{marginLeft:2,color:o?h.palette.background.default:h.palette.text.primary},children:n}),(0,f.jsx)(a.A,{sx:{flexGrow:1}})]})})}},8700:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var r=n(9950),a=n(6491),o=n(249),i=n(6050),s=n(2235),l=n(2053),c=n(8145),d=n(2046),u=n(5333),f=n(5471),x=n(4414),h=(0,f.A)((0,x.jsx)("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72z"}),"Mic"),p=n(1673),v=n(4857),m=n(4889),A=n(5619),j=n(9344),g=n(3564);var k=()=>{const{id:e}=(0,g.g)(),t=(0,m.Ht)("USER_SESSION"),[n,f]=(0,r.useState)({}),k=(0,v.A)(),y=(0,r.useRef)(null),[b,S]=(0,r.useState)([]),C={role:"assistant",content:`Hola ${null===t||void 0===t?void 0:t.firstname}, soy tu asistente de rehabilitaci\xf3n. \xbfEn qu\xe9 puedo ayudarte hoy?`},[_,w]=(0,r.useState)(""),[E,D]=(0,r.useState)(!1),[L,R]=(0,r.useState)(!1),z=async()=>{if(""!==_.trim()){D(!0);try{const r={conversation_id:e,user_id:t.id,content:_},a={role:"user",content:(await(0,m.LS)(m.XS,r)).content};S((e=>[...e,a])),w(""),R(!0);const o=await(0,m.UP)(_),i={conversation_id:e,user_id:n.id,content:o},s={role:"assistant",content:(await(0,m.LS)(m.XS,i)).content};S((e=>[...e,s]))}catch(r){console.log(r)}finally{D(!1),R(!1)}}};return(0,r.useEffect)((()=>{fetch(m.hk+`/${e}`).then((e=>e.json())).then((e=>{const n=null===e||void 0===e?void 0:e.participantes.find((e=>e.id!==(null===t||void 0===t?void 0:t.id)));var r;f(n),S([...(r=null===e||void 0===e?void 0:e.mensajes,r.map((e=>({role:e.user_id==t.id?"user":"assistant",content:e.content})))),C])})).catch((e=>console.log(e)))}),[]),(0,r.useEffect)((()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)}),[b]),(0,x.jsxs)(a.A,{sx:{backgroundColor:k.palette.grey[200],height:"100vh",display:"flex",flexDirection:"column"},children:[(0,x.jsx)(A.A,{avatarImage:m.QU+(null===n||void 0===n?void 0:n.image)||"",title:`${(null===n||void 0===n?void 0:n.firstname)||""} ${(null===n||void 0===n?void 0:n.lastname)||""}`,isDark:!1}),(0,x.jsxs)(o.A,{ref:y,sx:{width:"100%",flexGrow:1,overflowY:"auto",padding:2},children:[b.map(((e,t)=>(0,x.jsx)(i.Ay,{sx:{justifyContent:"user"===e.role?"flex-end":"flex-start",alignItems:"flex-start",marginBottom:1},children:(0,x.jsx)(s.A,{elevation:1,sx:{padding:2,maxWidth:"70%",backgroundColor:"user"===e.role?k.palette.secondary.main:"#fff",borderTopLeftRadius:"assistant"===e.role?"0":"auto",borderTopRightRadius:"user"===e.role?"0":"auto"},children:(0,x.jsx)(l.A,{style:{color:"user"===e.role?"#fff":"#000"},children:e.content})})},t))),L&&(0,x.jsx)(i.Ay,{sx:{justifyContent:"flex-start"},children:(0,x.jsx)(s.A,{elevation:1,sx:{padding:2,backgroundColor:"#f0f0f0",borderRadius:"auto"},children:(0,x.jsx)(l.A,{children:"Escribiendo..."})})})]}),(0,x.jsx)(a.A,{sx:{padding:2,backgroundColor:"#fff"},children:(0,x.jsx)(c.A,{placeholder:"Escribe un mensaje...",multiline:!0,maxRows:4,value:_,onChange:e=>w(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),z())},fullWidth:!0,variant:"outlined",InputProps:{endAdornment:(0,x.jsxs)(d.A,{position:"end",children:[(0,x.jsx)(u.A,{color:"default",onClick:()=>(0,m.T6)(`/#/${j.Ii.isNativePlatform()?"chat-voz/":"chat-voz-web/"}${e}`),children:(0,x.jsx)(h,{})}),(0,x.jsx)(u.A,{color:"secondary",onClick:z,disabled:E,children:(0,x.jsx)(p.A,{})})]})}})})]})}},7182:function(e,t,n){var r=n(5471),a=n(4414);t.A=(0,r.A)((0,a.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")},1673:function(e,t,n){var r=n(5471),a=n(4414);t.A=(0,r.A)((0,a.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send")}}]);