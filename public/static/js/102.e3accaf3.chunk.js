"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[102],{5619:function(e,t,a){var r=a(7182),i=a(6491),n=a(8079),o=a(5208),s=a(8060),l=a(3239),c=a(2053),d=a(4857),u=a(3564),h=a(4414);const p=e=>{let{icon:t,onClick:a,isDark:r}=e;const s=(0,d.A)();return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(i.A,{sx:{ml:2,mr:3,[s.breakpoints.down("md")]:{mr:2}},children:(0,h.jsx)(n.A,{children:(0,h.jsx)(o.A,{sx:{...s.typography.commonAvatar,...s.typography.mediumAvatar,transition:"all .2s ease-in-out",background:r?s.palette.secondary.main:s.palette.background.default,color:r?s.palette.background.default:s.palette.secondary.main},onClick:a,color:"inherit",children:t})})})})};t.A=e=>{let{avatarImage:t=null,title:a=null,isDark:n=!0}=e;const f=(0,d.A)(),x=(0,u.Zp)();return(0,h.jsx)(s.A,{enableColorOnDark:!0,color:"inherit",position:"relative",elevation:0,sx:{bgcolor:n?f.palette.secondary.main:f.palette.background.default},children:(0,h.jsxs)(l.A,{children:[(0,h.jsx)(p,{icon:(0,h.jsx)(r.A,{stroke:1.5,size:"1.3rem"}),onClick:()=>{x(-1)},isDark:n}),t&&(0,h.jsx)(o.A,{alt:"",src:t}),a&&(0,h.jsx)(c.A,{variant:"h4",sx:{marginLeft:2,color:n?f.palette.background.default:f.palette.text.primary},children:a}),(0,h.jsx)(i.A,{sx:{flexGrow:1}})]})})}},4355:function(e,t,a){a(9950);var r=a(6491),i=a(4414);t.A=e=>{let{isActive:t,backgroundColor:a="#000",color:n="#fff"}=e;return(0,i.jsx)(r.A,{sx:{width:300,height:300,borderRadius:"50%",backgroundColor:a,position:"relative",overflow:"hidden"},children:t&&(0,i.jsx)(r.A,{sx:{position:"absolute",bottom:0,width:"100%",height:"100%",display:"flex",alignItems:"flex-end",justifyContent:"center",gap:"4px",padding:"0 10px"},children:[...Array(20)].map(((e,t)=>(0,i.jsx)(r.A,{sx:{width:"4%",height:"20%",backgroundColor:n,animation:"spectro 1.5s infinite",animationDelay:.1*t+"s"}},t)))})})}},1721:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var r=a(9950),i=a(6491),n=a(2053),o=a(5333),s=a(6676),l=a(7835),c=a(4857),d=a(5619),u=a(4355),h=a(4889);const p=(0,a(9344).F3)("SpeechRecognition",{web:()=>a.e(711).then(a.bind(a,6711)).then((e=>new e.SpeechRecognitionWeb))});var f=a(3564),x=a(4414);var v=()=>{const{id:e}=(0,f.g)(),t=(0,h.Ht)("USER_SESSION"),[a,v]=(0,r.useState)({}),m=(0,c.A)(),[g,A]=(0,r.useState)(!1),[b,y]=(0,r.useState)(!1),[j,k]=(0,r.useState)(!1),[S,w]=(0,r.useState)(""),C=(0,r.useRef)(S);(0,r.useEffect)((()=>{C.current=S}),[S]),(0,r.useEffect)((()=>{fetch(h.hk+`/${e}`).then((e=>e.json())).then((e=>{const a=null===e||void 0===e?void 0:e.participantes.find((e=>e.id!==(null===t||void 0===t?void 0:t.id)));v(a)})).catch((e=>console.log(e)))}),[]),(0,r.useEffect)((()=>(E(),(0,h.dk)(`Hola ${null===t||void 0===t?void 0:t.firstname}, soy tu asistente de rehabilitaci\xf3n. \xbfEn qu\xe9 puedo ayudarte hoy?`,y),()=>{p.removeAllListeners()})),[]);const E=async()=>{try{const{available:e}=await p.available();if(!e)return void(0,h.P5)("error","El reconocimiento de voz no est\xe1 disponible en este dispositivo.");"granted"!==(await p.requestPermissions()).speechRecognition&&(0,h.P5)("error","Permiso de micr\xf3fono denegado. Por favor, habil\xedtalo en la configuraci\xf3n de la aplicaci\xf3n.")}catch(e){console.error("Error al verificar disponibilidad:",e),(0,h.P5)("error",`Error al verificar disponibilidad: ${e.message}`)}},_=async()=>{const r=C.current;if(""!==r.trim())try{k(!0);const i={conversation_id:e,user_id:t.id,content:r},n=await(0,h.LS)(h.XS,i),o=await(0,h.UP)(n.content),s={conversation_id:e,user_id:a.id,content:o},l=await(0,h.LS)(h.XS,s);k(!1),(0,h.dk)(l.content,y)}catch(i){(0,h.P5)("error","Error al obtener la respuesta de la IA"+i)}finally{w(""),k(!1)}};return(0,x.jsxs)(i.A,{sx:{backgroundColor:m.palette.grey[200],height:"100vh",display:"flex",flexDirection:"column"},children:[(0,x.jsx)(d.A,{avatarImage:h.QU+(null===a||void 0===a?void 0:a.image)||"",title:`${null===a||void 0===a?void 0:a.firstname} ${null===a||void 0===a?void 0:a.lastname}`,isDark:!1}),(0,x.jsxs)(i.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,x.jsx)(u.A,{isActive:g||b,backgroundColor:m.palette.grey[200],color:m.palette.secondary.main}),(0,x.jsx)(n.A,{variant:"h6",sx:{mt:2,color:m.palette.secondary.main},children:g?"Escuchando...":j?"Generando respuesta...":b?"Hablando...":"Presiona el bot\xf3n para hablar"}),(0,x.jsx)(n.A,{variant:"",sx:{mt:2},children:S})]}),(0,x.jsx)(i.A,{sx:{padding:1,display:"flex",justifyContent:"center"},children:(0,x.jsx)(o.A,{color:"secondary",onClick:async()=>{g||await(async()=>{try{await p.start({language:"es-ES",maxResults:1,prompt:"Habla ahora",partialResults:!0,popup:!1}),p.addListener("partialResults",(e=>{e.matches&&e.matches.length>0&&w(e.matches[0])})),p.addListener("listeningState",(e=>{"started"==e.status?A(!0):(A(!1),_())}))}catch(e){console.error("Error al iniciar el reconocimiento de voz:",e),(0,h.P5)("error",`Error al iniciar el reconocimiento de voz: ${e.message}`)}})()},sx:{width:60,height:60},disabled:b||j,children:g?(0,x.jsx)(l.A,{sx:{fontSize:40}}):(0,x.jsx)(s.A,{sx:{fontSize:40}})})})]})}},6676:function(e,t,a){var r=a(4994);t.A=void 0;var i=r(a(9526)),n=a(4414);t.A=(0,i.default)((0,n.jsx)("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72z"}),"Mic")},7835:function(e,t,a){var r=a(4994);t.A=void 0;var i=r(a(9526)),n=a(4414);t.A=(0,i.default)((0,n.jsx)("path",{d:"M6 6h12v12H6z"}),"Stop")},7182:function(e,t,a){var r=a(5471),i=a(4414);t.A=(0,r.A)((0,i.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")}}]);